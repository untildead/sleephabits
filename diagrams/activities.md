```mermaid
flowchart TD
    A[Usuario abre la app] --> B[Accede a /subjects]
    B --> C["Registra sujeto<br/>nombre, edad, género"]
    C --> D["Validación de datos<br/>(requeridos, rango, género F/M/O)"]
    D -->|Error| E["Muestra mensajes de error<br/>y resalta campos"]
    D -->|OK| F[Sujeto guardado en BD]
    F --> G[Accede a /records]
    G --> H["Registra noche de sueño<br/>fecha, horas, eficiencia, despertares"]
    H --> I["Validación de fechas/horas<br/>coherencia inicio/fin"]
    I -->|Error| J["Muestra mensajes de error<br/>sin guardar registro"]
    I -->|OK| K[SleepRecord guardado en BD]
    K --> L[Usuario navega a /dashboard]
    L --> M[Frontend llama /api/reports/timeseries]
    L --> N[Frontend llama /api/reports/habits_quality]
    M --> O["API calcula promedios diarios<br/>de duración de sueño"]
    N --> P["API agrupa eficiencia y duración<br/>por tags de hábitos"]
    O --> Q["Gráfico de línea<br/>duración promedio"]
    P --> R["Gráfico de barras<br/>hábitos vs eficiencia"]
    Q --> S[Usuario interpreta tendencias]
    R --> S
